= TODOs

== Issues

=== docs_server indexiert neue Dateien nicht automatisch

**Problem:** Der docs_server erkennt neu erstellte .adoc Dateien nicht automatisch und kann sie daher nicht Ã¼ber die MCP API bearbeiten.

**Details:**
- Neue Datei `test-docs/mein-test.adoc` erstellt
- `docs_server___search_content` findet "Hello World" nicht
- Fallback auf `fs_write` nÃ¶tig fÃ¼r neue Dateien

**LÃ¶sung:** âœ… IMPLEMENTIERT
- `refresh_index` API-Befehl hinzugefÃ¼gt
- Manueller Refresh mÃ¶glich Ã¼ber MCP API

**Status:** âœ… GELÃ–ST

=== get_structure zeigt gesamte Projektstruktur statt nur test-docs

**Problem:** `docs_server___get_structure` zeigt die komplette Dokumentation des Projekts an, nicht nur die Struktur der Datei `test-docs/mein-test.adoc`.

**Details:**
- User erwartet nur die Struktur von `mein-test.adoc`
- Server zeigt alle Dokumente im Projekt (todos.adoc, manual.adoc, etc.)
- MissverstÃ¤ndnis zwischen Einzeldokument vs. Projektstruktur

**Status:** âŒ OFFEN - KlÃ¤rung der erwarteten FunktionalitÃ¤t nÃ¶tig

=== get_section API Fehler: 'str' object has no attribute 'id'

**Problem:** `docs_server___get_section` wirft einen internen Fehler beim Aufruf.

**Details:**
- Fehlercode: -32603
- Fehlermeldung: "'str' object has no attribute 'id'"
- Aufruf: `docs_server___get_section {"path": "todos.issues"}`
- Server-seitiger Bug in der Section-Verarbeitung

**LÃ¶sung:** âœ… IMPLEMENTIERT
- Bug in `get_section` method gefixt: `child.id` â†’ `child.id if hasattr(child, 'id') else str(child)`
- Bug in `get_structure` method gefixt: Safe children_count berechnung
- Test hinzugefÃ¼gt: `test_get_section_bug_fix`

**Status:** âœ… GELÃ–ST

== ğŸš¨ FEHLENDE PRD-REQUIREMENTS (HÃ–CHSTE PRIORITÃ„T)

=== Web Server & Interface (Must-Have)
**Status:** âœ… IMPLEMENTIERT
- âœ… Simple HTTP server fÃ¼r Visualization Interface (FastAPI)
- âœ… Document Visualization (Dokumentstruktur anzeigen)
- âœ… Real-time Diff Display (rot/grÃ¼n Diffs nach Ã„nderungen)
- âœ… Navigation Interface (Web UI zum Browsen der Hierarchie)
- âœ… Startup Script: `./start_web_server.sh`

=== Meta-Information API (Must-Have)
**Status:** âœ… IMPLEMENTIERT
- âœ… `get_metadata(path)` â†’ File info, word count, last modified
- âœ… `get_dependencies()` â†’ Include-tree, cross-references
- âœ… `validate_structure()` â†’ Consistency check

=== Diff Engine (Core Component)
**Status:** âœ… IMPLEMENTIERT
- âœ… Change detection and visualization
- âœ… Integration mit Web Interface fÃ¼r real-time Diffs
- âœ… HTML diff generation

== Web Interface Verbesserungen

=== UI/UX Verbesserungen (Neue Anforderungen)
**Status:** ğŸ”„ IN ARBEIT
- âœ… Untersektionen sollen sortiert (entsprechend ihrer Position im Dokument) aufgefÃ¼hrt sein
- âœ… Die Sektionen sollen bis zum letzten Child aufklapbar sein
- âŒ Sektion anklicken â†’ rechts als vollstÃ¤ndiges Dokument anzeigen

**Implementiert:**
- âœ… `get_structure()` sortiert jetzt nach `line_start` (Dokumentposition)
- âœ… Web Interface JavaScript sortiert Sections nach `line_start` und Titel
- âœ… Test hinzugefÃ¼gt: `test_api_structure_sorted_by_document_position`
- âœ… Hierarchische Struktur mit `children` Arrays implementiert
- âœ… Aufklappbare Hierarchie mit â–¶/â–¼ Icons
- âœ… Rekursive Darstellung aller Ebenen bis zum letzten Child
- âœ… Test hinzugefÃ¼gt: `test_api_structure_hierarchical_children`, `test_web_interface_expandable_hierarchy`
- âœ… Farbkodierte Level (Level 1-4 verschiedene Farben)
- âœ… Anzeige zeigt Zeilennummer fÃ¼r Debugging: `[line: X]`

=== Content-Extraktion Features (Neue Anforderungen)
**Status:** âŒ OFFEN
- `get_diagrams()` â†’ Alle PlantUML/Mermaid Diagramme auflisten
- `get_tables()` â†’ Alle Tabellen extrahieren und strukturiert zurÃ¼ckgeben
- `get_code_blocks()` â†’ Code-Snippets nach Sprache filtern
- `get_images()` â†’ Alle Bilder/Grafiken auflisten

=== Web Interface Bugs (Playwright Test Ergebnisse)

**Status:** âœ… BEHOBEN (TDD London School Ansatz)

==== JavaScript Fehler beim Load Structure
**Problem:** TypeError beim Aufbau der Hierarchie
- Fehler: `Cannot read properties of null (reading 'appendChild')`
- **Status:** âœ… BEHOBEN - Durch korrekte Datenstruktur behoben

==== Fehlende Favicon
**Problem:** 404 Fehler fÃ¼r favicon.ico
- Fehler: `Failed to load resource: the server responded with a status of 404`
- **Status:** âŒ OFFEN - Kosmetisches Problem, niedrige PrioritÃ¤t

==== Fehlende Right Panel fÃ¼r Section Content
**Problem:** Kein rechtes Panel fÃ¼r Dokumentanzeige
- Erwartung: Sektion anklicken â†’ rechts als vollstÃ¤ndiges Dokument anzeigen
- Aktuell: Content wird inline unter der Sektion angezeigt
- **Status:** âŒ OFFEN - Feature noch nicht implementiert (siehe UI/UX Verbesserungen)

==== Fehlende Dokumente und falsche Sortierung
**Problem:** Kritische Strukturfehler in der Dokumentanzeige
- **Fehlende Inhalte:** Kapitel 1 (Introduction) wird nicht angezeigt
- **Falsche Sortierung:** Reihenfolge ist 10,11,12,2,3,4,5,6,7,8,9 statt 1,2,3,4,5,6,7,8,9,10,11,12
- **Regression:** Andere Dokumente (todos.adoc, manual.adoc, etc.) verschwunden
- **Status:** âœ… VOLLSTÃ„NDIG BEHOBEN
  - Neue `get_main_chapters()` Methode implementiert
  - Korrekte Erkennung von arc42-Kapiteln auf Level 2
  - JavaScript-Sortierung nach `chapter_number` statt `line_start`
  - Alle 12 arc42-Kapitel werden in korrekter Reihenfolge angezeigt (1-12)
  - Alle anderen Dokumente (23+) werden nach den Kapiteln alphabetisch angezeigt
  - TDD-Tests implementiert und bestehen alle

**Implementierte Fixes:**
- âœ… `MCPDocumentationServer.get_main_chapters()` - Erkennt arc42-Kapitel + andere Dokumente
- âœ… Web-API verwendet neue Methode fÃ¼r `/api/structure`
- âœ… JavaScript sortiert nach `chapter_number` statt `line_start`
- âœ… TDD-Tests in `test_web_interface_bugs.py` (4 Tests, alle bestehen)
- âœ… Regression behoben: Alle Dokumente wieder sichtbar

=== VerbesserungsvorschlÃ¤ge

=== Kritische Verbesserungen

==== Auto-Indexing neuer Dateien
- File-Watcher fÃ¼r neue .adoc/.md Dateien
- Automatisches Re-Indexing ohne Server-Neustart
- `refresh_index` API-Befehl

==== Batch-Operationen
- `update_multiple_sections` fÃ¼r mehrere Ã„nderungen auf einmal
- `get_multiple_sections` fÃ¼r effiziente Bulk-Abfragen
- Transaktionale Updates (alles oder nichts)

=== Navigation & Usability

==== Erweiterte Suche
- Suche nur in bestimmten Dokumenten/Sektionen
- Regex-UnterstÃ¼tzung
- Fuzzy-Search fÃ¼r Pfade

==== Bessere Pfad-Navigation
- `get_parent_section` / `get_child_sections`
- `get_siblings` fÃ¼r Navigation auf gleicher Ebene
- Breadcrumb-Pfade in Antworten

=== Performance & Skalierung

==== Caching
- In-Memory Cache fÃ¼r hÃ¤ufig abgerufene Sektionen
- Intelligente Cache-Invalidierung bei Ã„nderungen
- Kompression fÃ¼r groÃŸe Inhalte

==== Streaming
- Streaming fÃ¼r sehr groÃŸe Sektionen
- Paginierung bei vielen Suchergebnissen
- Lazy-Loading von Untersektionen

=== Developer Experience

==== Validierung & Feedback
- AsciiDoc/Markdown Syntax-Validierung vor Updates
- Preview-Modus fÃ¼r Ã„nderungen
- Diff-Anzeige bei Updates

==== Erweiterte Formate
- PlantUML-Diagramm Extraktion
- Code-Block Highlighting
- Tabellen als strukturierte Daten

== MCP-Server Auto-Start Features

=== Automatischer Webserver-Start beim MCP-Server Start
**Status:** âœ… IMPLEMENTIERT

**Problem:** Der MCP-Server startet nicht automatisch den Webserver

**LÃ¶sung:** âœ… VOLLSTÃ„NDIG IMPLEMENTIERT
- âœ… Port-Scanning fÃ¼r freie Ports implementiert (`PortScanner` Klasse)
- âœ… Webserver-Start in MCP-Server Startup-Prozess integriert (`AutoStartManager`)
- âœ… Browser-Auto-Open Feature implementiert (`BrowserLauncher`)
- âœ… TDD London School Ansatz mit umfangreichen Tests (12 Unit Tests)
- âœ… Integration in `MCPDocumentationServer` mit `enable_webserver` Parameter
- âœ… Webserver unterstÃ¼tzt `--port` Parameter fÃ¼r flexible Port-Konfiguration

**Implementierte Features:**
- **Port-Scanning:** Automatische Suche nach freien Ports in konfigurierbarem Bereich
- **Webserver-Management:** Startet/stoppt Webserver-Prozesse automatisch
- **Browser-Launch:** Ã–ffnet automatisch Browser mit Webserver-URL
- **Fehlerbehandlung:** Graceful handling bei Port-Konflikten oder Browser-Fehlern
- **Status-API:** `get_webserver_status()` und `restart_webserver()` Methoden

**Technische Details:**
- Modular aufgebaut mit separaten Klassen fÃ¼r Port-Scanning, Webserver-Management und Browser-Launch
- Dependency Injection fÃ¼r einfache Testbarkeit
- VollstÃ¤ndige Test-Abdeckung mit Mocks (TDD London School)
- Integration erfolgt automatisch beim MCP-Server Start mit `enable_webserver=True`

**PrioritÃ¤t:** âœ… ABGESCHLOSSEN - Alle Anforderungen erfÃ¼llt
