<?xml version='1.0' encoding='US-ASCII' standalone='no'?><svg contentStyleType='text/css' height='1112px' preserveAspectRatio='none' style='width:1499px;height:1112px;background:#FFFFFF;' version='1.1' viewBox='0 0 1499 1112' width='1499px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' zoomAndPan='magnify'><defs/><g><text fill='#000000' font-family='sans-serif' font-size='14' font-weight='bold' lengthAdjust='spacing' textLength='491' x='500' y='27.9951'>Sequence Diagram: MCP Protocol Request Handling (FastMCP)</text><rect fill='#FFFFFF' height='895.8516' style='stroke:#181818;stroke-width:1.0;' width='10' x='460' y='162.9922'/><rect fill='#FFFFFF' height='474.125' style='stroke:#181818;stroke-width:1.0;' width='10' x='783' y='420.0547'/><rect fill='#FFFFFF' height='214.9297' style='stroke:#181818;stroke-width:1.0;' width='10' x='1146' y='650.1172'/><rect fill='#FFFFFF' height='79.3984' style='stroke:#181818;stroke-width:1.0;' width='10' x='1346' y='679.25'/><line style='stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;' x1='49' x2='49' y1='73.5938' y2='1076.8438'/><line style='stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;' x1='464.5' x2='464.5' y1='73.5938' y2='1076.8438'/><line style='stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;' x1='788' x2='788' y1='73.5938' y2='1076.8438'/><line style='stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;' x1='1151' x2='1151' y1='73.5938' y2='1076.8438'/><line style='stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;' x1='1350.5' x2='1350.5' y1='73.5938' y2='1076.8438'/><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='88' x='5' y='42.2969'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='74' x='12' y='62.292'>MCP Client</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='88' x='5' y='1075.8438'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='74' x='12' y='1095.8389'>MCP Client</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='107' x='411.5' y='42.2969'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='93' x='418.5' y='62.292'>FastMCP SDK</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='107' x='411.5' y='1075.8438'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='93' x='418.5' y='1095.8389'>FastMCP SDK</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='98' x='739' y='42.2969'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='84' x='746' y='62.292'>@mcp.tool()</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='98' x='739' y='1075.8438'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='84' x='746' y='1095.8389'>@mcp.tool()</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='132' x='1085' y='42.2969'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='118' x='1092' y='62.292'>document_api.py</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='132' x='1085' y='1075.8438'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='118' x='1092' y='1095.8389'>document_api.py</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='119' x='1291.5' y='42.2969'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='105' x='1298.5' y='62.292'>Structure Index</text><rect fill='#E2E2F0' height='30.2969' rx='2.5' ry='2.5' style='stroke:#181818;stroke-width:0.5;' width='119' x='1291.5' y='1075.8438'/><text fill='#000000' font-family='sans-serif' font-size='14' lengthAdjust='spacing' textLength='105' x='1298.5' y='1095.8389'>Structure Index</text><rect fill='#FFFFFF' height='895.8516' style='stroke:#181818;stroke-width:1.0;' width='10' x='460' y='162.9922'/><rect fill='#FFFFFF' height='474.125' style='stroke:#181818;stroke-width:1.0;' width='10' x='783' y='420.0547'/><rect fill='#FFFFFF' height='214.9297' style='stroke:#181818;stroke-width:1.0;' width='10' x='1146' y='650.1172'/><rect fill='#FFFFFF' height='79.3984' style='stroke:#181818;stroke-width:1.0;' width='10' x='1346' y='679.25'/><rect fill='#EEEEEE' height='3' style='stroke:#EEEEEE;stroke-width:1.0;' width='1492' x='0' y='104.1602'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='104.1602' y2='104.1602'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='107.1602' y2='107.1602'/><rect fill='#EEEEEE' height='23.1328' style='stroke:#000000;stroke-width:2.0;' width='118' x='687' y='93.5938'/><text fill='#000000' font-family='sans-serif' font-size='13' font-weight='bold' lengthAdjust='spacing' textLength='99' x='693' y='109.6606'>MCP Request</text><polygon fill='#181818' points='448,158.9922,458,162.9922,448,166.9922,452,162.9922' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;' x1='49' x2='454' y1='162.9922' y2='162.9922'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='172' x='56' y='142.7935'>JSON-RPC request via stdin</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='392' x='56' y='157.9263'>{"method": "tools/call", "params": {"name": "get_structure"}}</text><line style='stroke:#181818;stroke-width:1.0;' x1='470' x2='512' y1='192.125' y2='192.125'/><line style='stroke:#181818;stroke-width:1.0;' x1='512' x2='512' y1='192.125' y2='205.125'/><line style='stroke:#181818;stroke-width:1.0;' x1='471' x2='512' y1='205.125' y2='205.125'/><polygon fill='#181818' points='481,201.125,471,205.125,481,209.125,477,205.125' style='stroke:#181818;stroke-width:1.0;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='102' x='477' y='187.0591'>parse JSON-RPC</text><path d='M475,218.125 L475,258.125 L613,258.125 L613,228.125 L603,218.125 L475,218.125 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M603,218.125 L603,228.125 L613,228.125 L603,218.125 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='117' x='481' y='235.1919'>Automatic parsing</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='46' x='481' y='250.3247'>by SDK</text><line style='stroke:#181818;stroke-width:1.0;' x1='470' x2='512' y1='284.5234' y2='284.5234'/><line style='stroke:#181818;stroke-width:1.0;' x1='512' x2='512' y1='284.5234' y2='297.5234'/><line style='stroke:#181818;stroke-width:1.0;' x1='471' x2='512' y1='297.5234' y2='297.5234'/><polygon fill='#181818' points='481,293.5234,471,297.5234,481,301.5234,477,297.5234' style='stroke:#181818;stroke-width:1.0;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='105' x='477' y='279.4575'>validate schema</text><path d='M475,310.5234 L475,350.5234 L583,350.5234 L583,320.5234 L573,310.5234 L475,310.5234 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M573,310.5234 L573,320.5234 L583,320.5234 L573,310.5234 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='87' x='481' y='327.5903'>Schema from</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='63' x='481' y='342.7231'>type hints</text><rect fill='#EEEEEE' height='3' style='stroke:#EEEEEE;stroke-width:1.0;' width='1492' x='0' y='376.3555'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='376.3555' y2='376.3555'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='379.3555' y2='379.3555'/><rect fill='#EEEEEE' height='23.1328' style='stroke:#000000;stroke-width:2.0;' width='119' x='686.5' y='365.7891'/><text fill='#000000' font-family='sans-serif' font-size='13' font-weight='bold' lengthAdjust='spacing' textLength='100' x='692.5' y='381.856'>Tool Dispatch</text><polygon fill='#181818' points='771,416.0547,781,420.0547,771,424.0547,775,420.0547' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;' x1='470' x2='777' y1='420.0547' y2='420.0547'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='294' x='477' y='414.9888'>get_structure(start_level=1, parent_id=None)</text><path d='M798,433.0547 L798,488.0547 L951,488.0547 L951,443.0547 L941,433.0547 L798,433.0547 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M941,433.0547 L941,443.0547 L951,443.0547 L941,433.0547 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='126' x='804' y='450.1216'>Decorated function:</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='79' x='804' y='465.2544'>@mcp.tool()</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='132' x='804' y='480.3872'>def get_structure(...)</text><line style='stroke:#181818;stroke-width:1.0;' x1='793' x2='835' y1='514.5859' y2='514.5859'/><line style='stroke:#181818;stroke-width:1.0;' x1='835' x2='835' y1='514.5859' y2='527.5859'/><line style='stroke:#181818;stroke-width:1.0;' x1='794' x2='835' y1='527.5859' y2='527.5859'/><polygon fill='#181818' points='804,523.5859,794,527.5859,804,531.5859,800,527.5859' style='stroke:#181818;stroke-width:1.0;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='147' x='800' y='509.52'>access _server (global)</text><path d='M798,540.5859 L798,580.5859 L961,580.5859 L961,550.5859 L951,540.5859 L798,540.5859 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M951,540.5859 L951,550.5859 L961,550.5859 L951,540.5859 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='142' x='804' y='557.6528'>Global server instance</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='81' x='804' y='572.7856'>set in main()</text><rect fill='#EEEEEE' height='3' style='stroke:#EEEEEE;stroke-width:1.0;' width='1492' x='0' y='606.418'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='606.418' y2='606.418'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='609.418' y2='609.418'/><rect fill='#EEEEEE' height='23.1328' style='stroke:#000000;stroke-width:2.0;' width='125' x='683.5' y='595.8516'/><text fill='#000000' font-family='sans-serif' font-size='13' font-weight='bold' lengthAdjust='spacing' textLength='106' x='689.5' y='611.9185'>Tool Execution</text><polygon fill='#181818' points='1134,646.1172,1144,650.1172,1134,654.1172,1138,650.1172' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;' x1='793' x2='1140' y1='650.1172' y2='650.1172'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='334' x='800' y='645.0513'>_server.doc_api.get_structure(start_level, parent_id)</text><polygon fill='#181818' points='1334,675.25,1344,679.25,1334,683.25,1338,679.25' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;' x1='1156' x2='1340' y1='679.25' y2='679.25'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='171' x='1163' y='674.1841'>access self.server.sections</text><path d='M1361,692.25 L1361,732.25 L1487,732.25 L1487,702.25 L1477,692.25 L1361,692.25 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M1477,692.25 L1477,702.25 L1487,702.25 L1477,692.25 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='105' x='1367' y='709.3169'>Shared state via</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='64' x='1367' y='724.4497'>DI pattern</text><polygon fill='#181818' points='1167,754.6484,1157,758.6484,1167,762.6484,1163,758.6484' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;' x1='1161' x2='1350' y1='758.6484' y2='758.6484'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='80' x='1173' y='753.5825'>sections dict</text><line style='stroke:#181818;stroke-width:1.0;' x1='1156' x2='1198' y1='787.7813' y2='787.7813'/><line style='stroke:#181818;stroke-width:1.0;' x1='1198' x2='1198' y1='787.7813' y2='800.7813'/><line style='stroke:#181818;stroke-width:1.0;' x1='1157' x2='1198' y1='800.7813' y2='800.7813'/><polygon fill='#181818' points='1167,796.7813,1157,800.7813,1167,804.7813,1163,800.7813' style='stroke:#181818;stroke-width:1.0;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='166' x='1163' y='782.7153'>_build_hierarchy(sections)</text><path d='M1161,813.7813 L1161,838.7813 L1326,838.7813 L1326,823.7813 L1316,813.7813 L1161,813.7813 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M1316,813.7813 L1316,823.7813 L1326,823.7813 L1316,813.7813 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='144' x='1167' y='830.8481'>Recursive tree building</text><polygon fill='#181818' points='804,861.0469,794,865.0469,804,869.0469,800,865.0469' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;' x1='798' x2='1150' y1='865.0469' y2='865.0469'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='240' x='810' y='859.981'>{"chapter-1": {...}, "chapter-2": {...}}</text><polygon fill='#181818' points='481,890.1797,471,894.1797,481,898.1797,477,894.1797' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;' x1='475' x2='787' y1='894.1797' y2='894.1797'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='66' x='487' y='889.1138'>return dict</text><rect fill='#EEEEEE' height='3' style='stroke:#EEEEEE;stroke-width:1.0;' width='1492' x='0' y='922.7461'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='922.7461' y2='922.7461'/><line style='stroke:#000000;stroke-width:1.0;' x1='0' x2='1492' y1='925.7461' y2='925.7461'/><rect fill='#EEEEEE' height='23.1328' style='stroke:#000000;stroke-width:2.0;' width='178' x='657' y='912.1797'/><text fill='#000000' font-family='sans-serif' font-size='13' font-weight='bold' lengthAdjust='spacing' textLength='159' x='663' y='928.2466'>Response Formatting</text><line style='stroke:#181818;stroke-width:1.0;' x1='470' x2='512' y1='966.4453' y2='966.4453'/><line style='stroke:#181818;stroke-width:1.0;' x1='512' x2='512' y1='966.4453' y2='979.4453'/><line style='stroke:#181818;stroke-width:1.0;' x1='471' x2='512' y1='979.4453' y2='979.4453'/><polygon fill='#181818' points='481,975.4453,471,979.4453,481,983.4453,477,979.4453' style='stroke:#181818;stroke-width:1.0;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='164' x='477' y='961.3794'>serialize_response(result)</text><path d='M475,992.4453 L475,1032.4453 L628,1032.4453 L628,1002.4453 L618,992.4453 L475,992.4453 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><path d='M618,992.4453 L618,1002.4453 L628,1002.4453 L618,992.4453 ' fill='#FEFFDD' style='stroke:#181818;stroke-width:0.5;'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='132' x='481' y='1009.5122'>Automatic JSON-RPC</text><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='107' x='481' y='1024.645'>wrapping by SDK</text><polygon fill='#181818' points='60,1054.8438,50,1058.8438,60,1062.8438,56,1058.8438' style='stroke:#181818;stroke-width:1.0;'/><line style='stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;' x1='54' x2='464' y1='1058.8438' y2='1058.8438'/><text fill='#000000' font-family='sans-serif' font-size='13' lengthAdjust='spacing' textLength='192' x='66' y='1053.7778'>JSON-RPC response via stdout</text></g></svg>